{"mappings":";;;;;;;;;;;;;MCAM,2BAAK;gBACI,OAAO,EAAE,IAAI,CAAE,CAAC;QAC3B,IAAI,CAAC,OAAO,GAAG,OAAO;QACtB,IAAI,CAAC,IAAI,GAAG,IAAI;IAClB,CAAC;IAED,EAGG,AAHH;;;GAGG,AAHH,EAGG,OACG,MAAM,GAAI,CAAC;QACf,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK;QAExB,GAAG,EAAE,GAAG,CAAC,KAAK,IAAI,KAAK,CAAE,CAAC;YACxB,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK;YAEnC,EAAE,EAAE,MAAM,KAAK,SAAS,EACtB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM;QAE3B,CAAC;QAED,MAAM,CAAC,IAAI,CAAC,IAAI;IAClB,CAAC;IAED,EAIG,AAJH;;;;GAIG,AAJH,EAIG,CACH,GAAG,CAAE,KAAK,EAAE,CAAC;QACX,MAAM,CAAC,GAAG,CAAC,OAAO,EAAE,OAAO,GAAK,CAAC;YAC/B,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,OAAO;QACnD,CAAC;IACH,CAAC;IAED,EAGG,AAHH;;;GAGG,AAHH,EAGG,CACH,KAAK,GAAI,CAAC;QACR,KAAK,CAAC,KAAK,GAAG,GAAG,CAAC,GAAG;QAErB,GAAG,EAAE,GAAG,CAAC,KAAK,IAAI,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,CACvC,EAAE,EAAE,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,CAAO,SACnC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,GAAG,EAAE,KAAK;QAIrD,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK;IACzB,CAAC;;IAGH,wCAEC,IAFe,EAAE,EAAE,IAAI,EAAE,IAAI,GAAK,CAAC;IAClC,GAAG,CAAC,2BAAK,CAAC,CAAC;YAAC,EAAE;cAAE,IAAI;IAAC,CAAC,EAAE,IAAI,EAAE,MAAM;AACtC,CAAC;;;ICtDD,wCAIC,IAJe,KAAK,GAAK,CAAC;IACzB,MAAM,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,GAAK,CAAC;QAC1B,KAAK,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI;IACtB,CAAC;AACH,CAAC;;;ICJD,wCA8BC,IA9Be,KAAK,GAAK,CAAC;IACzB,GAAG,CAAC,IAAI,GAAG,IAAI;IAEf,KAAK,CAAC,OAAO,IAAI,EAAE,EAAE,IAAI,EAAE,IAAI,GAAK,CAAC;QACnC,GAAG,CAAC,IAAI,GAAG,KAAK;QAEhB,EAAE,EAAE,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,EAAE,CAAC,IAAI,KAAK,EAAE,CAAC,IAAI,EAClE,IAAI,GAAG,IAAI;QAGb,EAAE,EAAE,IAAI,EACN,IAAI,GAAG,IAAI;aAEX,IAAI,GAAG,CAAC;gBAAC,EAAE;kBAAE,IAAI;QAAC,CAAC;QAGrB,EAAE,EAAE,IAAI,EACN,MAAM,CAAC,IAAI;QAGb,GAAG,CAAE,GAAG,CAAC,KAAK,IAAI,IAAI,CAAC,OAAO,CAAE,CAAC;YAC/B,EAAE,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,cAAc,CAAC,CAAO,WAAK,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO,CAAC,KAAK,MAAM,EAAE,CAAC,OAAO,CAAC,KAAK,GAClJ,MAAM,CAAC,IAAI;QAEf,CAAC;QAED,KAAK,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI;IACtB,CAAC;IAED,MAAM,CAAC,OAAO;AAChB,CAAC;;;IC9BD,wCAYC,IAZe,KAAK,GAAK,CAAC;IACzB,KAAK,CAAC,OAAO,IAAI,EAAE,EAAE,IAAI,EAAE,IAAI,GAAK,CAAC;QACnC,GAAG,CAAE,GAAG,CAAC,KAAK,IAAI,IAAI,CAAC,OAAO,CAAE,CAAC;YAC/B,EAAE,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,cAAc,CAAC,CAAO,WAAK,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO,CAAC,KAAK,MAAM,EAAE,CAAC,OAAO,CAAC,KAAK,GAClJ,MAAM,CAAC,KAAK,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI;QAE/B,CAAC;QAED,IAAI;IACN,CAAC;IAED,MAAM,CAAC,OAAO;AAChB,CAAC;;;kDJN+B,GAAG,EAAE,OAAO,EAAE,CAAC;IAC7C,EAAE,EAAE,OAAO,CAAC,OAAO,MAAM,IAAI,IAAI,OAAO,CAAC,cAAc,CAAC,CAAQ,aAAM,IAAI,EACxE,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAA0D;IAG5E,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,wCAAK;AACjC,CAAC","sources":["src/index.js","src/Guard.js","src/Guards/BeforeEach.js","src/Guards/BeforeEnter.js","src/Guards/BeforeUpdate.js"],"sourcesContent":["import Guard from './Guard'\n\nexport BeforeEach from './Guards/BeforeEach'\nexport BeforeEnter from './Guards/BeforeEnter'\nexport BeforeUpdate from './Guards/BeforeUpdate'\n\nexport default function install(vue, options) {\n  if (Boolean(options) !== true || options.hasOwnProperty('router') !== true) {\n    throw new Error('A Vue Router instance must be given to vue-router-shield')\n  }\n\n  options.router.beforeEach(Guard)\n}\n","class Guard {\n  constructor (request, next) {\n    this.request = request\n    this.next = next\n  }\n\n  /**\n   * Handle the guards\n   * @return mixed\n   */\n  async handle () {\n    const chain = this.chain()\n\n    for (let guard of chain) {\n      const result = await this.run(guard)\n\n      if (result !== undefined) {\n        return this.next(result)\n      }\n    }\n\n    return this.next()\n  }\n\n  /**\n   * Run a guard\n   * @param  function guard\n   * @return promise\n   */\n  run (guard) {\n    return new Promise((resolve) => {\n      guard(this.request.to, this.request.from, resolve)\n    })\n  }\n\n  /**\n   * Build the guards chain\n   * @return array\n   */\n  chain () {\n    const chain = new Set()\n\n    for (let route of this.request.to.matched) {\n      if (route.meta.hasOwnProperty('guard')) {\n        route.meta.guard.forEach(Set.prototype.add, chain)\n      }\n    }\n\n    return Array.from(chain)\n  }\n}\n\nexport default (to, from, next) => {\n  new Guard({ to, from }, next).handle()\n}\n","export default (guard) => {\n  return (to, from, next) => {\n    guard(to, from, next)\n  }\n}\n","export default (guard) => {\n  let last = null\n\n  const wrapper = (to, from, next) => {\n    let skip = false\n\n    if (last && last.from.path === from.path && last.to.path !== to.path) {\n      skip = true\n    }\n\n    if (skip) {\n      last = null\n    } else {\n      last = { to, from }\n    }\n\n    if (skip) {\n      return next()\n    }\n\n    for (let index in from.matched) {\n      if (from.matched[index].meta.hasOwnProperty('guard') && from.matched[index].meta.guard.includes(wrapper) && from.matched[index] === to.matched[index]) {\n        return next()\n      }\n    }\n\n    guard(to, from, next)\n  }\n\n  return wrapper\n}\n","export default (guard) => {\n  const wrapper = (to, from, next) => {\n    for (let index in from.matched) {\n      if (from.matched[index].meta.hasOwnProperty('guard') && from.matched[index].meta.guard.includes(wrapper) && from.matched[index] === to.matched[index]) {\n        return guard(to, from, next)\n      }\n    }\n\n    next()\n  }\n\n  return wrapper\n}\n"],"names":[],"version":3,"file":"index.js.map"}