{"mappings":"qVAAMA,cACSC,EAASC,GACpBC,KAAKF,QAAUA,EACfE,KAAKD,KAAOA,EAMXE,eAED,MAAMC,EAAQF,KAAKE,QAEnB,IAAK,IAAIC,KAASD,EAAO,CACvB,MAAME,QAAeJ,KAAKK,IAAIF,GAE9B,QAAeG,IAAXF,EACF,OAAOJ,KAAKD,KAAKK,GAIrB,OAAOJ,KAAKD,OAQdM,IAAKF,GACH,OAAO,IAAII,SAASC,IAClBL,EAAMH,KAAKF,QAAQW,GAAIT,KAAKF,QAAQY,KAAMF,MAQ9CN,QACE,MAAMA,EAAQ,IAAIS,IAElB,IAAK,IAAIC,KAASZ,KAAKF,QAAQW,GAAGI,QAC5BD,EAAME,KAAKC,eAAe,UAC5BH,EAAME,KAAKX,MAAMa,QAAQL,IAAIM,UAAUC,IAAKhB,GAIhD,OAAOiB,MAAMT,KAAKR,QAItBkB,EAEC,CAFeX,EAAIC,EAAMX,KACxB,IAAIF,EAAM,IAAEY,OAAIC,GAAQX,GAAMsB,UCrDhCC,EAAgBnB,GACR,CAAEM,EAAIC,EAAMX,KAChBI,EAAMM,EAAIC,EAAMX,ICFpBwB,EAAgBpB,IACd,IAAIqB,EAAO,KAEX,MAAMC,EAAO,CAAIhB,EAAIC,EAAMX,KACzB,IAAI2B,GAAO,EAYX,GAVIF,GAAQA,EAAKd,KAAKiB,OAASjB,EAAKiB,MAAQH,EAAKf,GAAGkB,OAASlB,EAAGkB,OAC9DD,GAAO,GAIPF,EADEE,EACK,KAEA,IAAEjB,OAAIC,GAGXgB,EACF,OAAO3B,IAGT,IAAK,IAAI6B,KAASlB,EAAKG,QACrB,GAAIH,EAAKG,QAAQe,GAAOd,KAAKC,eAAe,UAAYL,EAAKG,QAAQe,GAAOd,KAAKX,MAAM0B,SAASJ,IAAYf,EAAKG,QAAQe,KAAWnB,EAAGI,QAAQe,GAC7I,OAAO7B,IAIXI,EAAMM,EAAIC,EAAMX,IAGlB,OAAO0B,GC7BTK,EAAgB3B,IACd,MAAMsB,EAAO,CAAIhB,EAAIC,EAAMX,KACzB,IAAK,IAAI6B,KAASlB,EAAKG,QACrB,GAAIH,EAAKG,QAAQe,GAAOd,KAAKC,eAAe,UAAYL,EAAKG,QAAQe,GAAOd,KAAKX,MAAM0B,SAASJ,IAAYf,EAAKG,QAAQe,KAAWnB,EAAGI,QAAQe,GAC7I,OAAOzB,EAAMM,EAAIC,EAAMX,GAI3BA,KAGF,OAAO0B,cCLuBM,EAAKC,GACnC,IAAyB,IAArBC,QAAQD,KAA0D,IAArCA,EAAQjB,eAAe,UACtD,MAAM,IAAImB,MAAM,4DAGlBF,EAAQG,OAAOC,WAAWhB","sources":["src/Guard.js","src/Guards/BeforeEach.js","src/Guards/BeforeEnter.js","src/Guards/BeforeUpdate.js","src/index.js"],"sourcesContent":["class Guard {\n  constructor (request, next) {\n    this.request = request\n    this.next = next\n  }\n\n  /**\n   * Handle the guards\n   * @return mixed\n   */\n  async handle () {\n    const chain = this.chain()\n\n    for (let guard of chain) {\n      const result = await this.run(guard)\n\n      if (result !== undefined) {\n        return this.next(result)\n      }\n    }\n\n    return this.next()\n  }\n\n  /**\n   * Run a guard\n   * @param  function guard\n   * @return promise\n   */\n  run (guard) {\n    return new Promise((resolve) => {\n      guard(this.request.to, this.request.from, resolve)\n    })\n  }\n\n  /**\n   * Build the guards chain\n   * @return array\n   */\n  chain () {\n    const chain = new Set()\n\n    for (let route of this.request.to.matched) {\n      if (route.meta.hasOwnProperty('guard')) {\n        route.meta.guard.forEach(Set.prototype.add, chain)\n      }\n    }\n\n    return Array.from(chain)\n  }\n}\n\nexport default (to, from, next) => {\n  new Guard({ to, from }, next).handle()\n}\n","export default (guard) => {\n  return (to, from, next) => {\n    guard(to, from, next)\n  }\n}\n","export default (guard) => {\n  let last = null\n\n  const wrapper = (to, from, next) => {\n    let skip = false\n\n    if (last && last.from.path === from.path && last.to.path !== to.path) {\n      skip = true\n    }\n\n    if (skip) {\n      last = null\n    } else {\n      last = { to, from }\n    }\n\n    if (skip) {\n      return next()\n    }\n\n    for (let index in from.matched) {\n      if (from.matched[index].meta.hasOwnProperty('guard') && from.matched[index].meta.guard.includes(wrapper) && from.matched[index] === to.matched[index]) {\n        return next()\n      }\n    }\n\n    guard(to, from, next)\n  }\n\n  return wrapper\n}\n","export default (guard) => {\n  const wrapper = (to, from, next) => {\n    for (let index in from.matched) {\n      if (from.matched[index].meta.hasOwnProperty('guard') && from.matched[index].meta.guard.includes(wrapper) && from.matched[index] === to.matched[index]) {\n        return guard(to, from, next)\n      }\n    }\n\n    next()\n  }\n\n  return wrapper\n}\n","import Guard from './Guard'\n\nexport BeforeEach from './Guards/BeforeEach'\nexport BeforeEnter from './Guards/BeforeEnter'\nexport BeforeUpdate from './Guards/BeforeUpdate'\n\nexport default function install(vue, options) {\n  if (Boolean(options) !== true || options.hasOwnProperty('router') !== true) {\n    throw new Error('A Vue Router instance must be given to vue-router-shield')\n  }\n\n  options.router.beforeEach(Guard)\n}\n"],"names":["$93b5ba20b7c6407f$var$Guard","request","next","this","async","chain","guard","result","run","undefined","Promise","resolve","to","from","Set","route","matched","meta","hasOwnProperty","forEach","prototype","add","Array","$93b5ba20b7c6407f$export$2e2bcd8739ae039","handle","$4dc324b33f6b41f4$export$2e2bcd8739ae039","$fdff557f561d4944$export$2e2bcd8739ae039","last","wrapper","skip","path","index","includes","$9d1ec6dcc9074941$export$2e2bcd8739ae039","vue","options","Boolean","Error","router","beforeEach"],"version":3,"file":"index.js.map"}